
<div class="container-fluid mt-4" style="width: 95%;">
    <h2>Gestión de Usuarios</h2>
<div class="d-flex justify-content-between mb-3">
    <button (click)="toggleForm()" class="btn btn-primary">Nuevo Usuario</button>
</div>
<table class="table table-striped table-bordered mt-3">
    <thead class="table-dark">
        <tr>
           
            <th>Nombre de Usuario</th>
            <th>Roles</th>
            <th *ngIf="muestraAcciones">Acciones</th>
        </tr>
    </thead>
    <tbody>
    <!--    <tr *ngFor="let usuario of usuarios; let i = index" style="text-align: center;"> -->
        @for (user of usuarios; track user.username){
            <tr>
            
            <td>{{ user.username }}</td> 
            <td>{{ user.roles }}</td>
            
 
            <td *ngIf="muestraAcciones">
                <button class="btn btn-warning btn-sm" (click)="editUsuario(user)">Editar</button>
                <button class="btn btn-danger btn-sm" (click)="deleteUsuario(user.username)">Eliminar</button>
            </td>
        </tr>  
    }@empty { 
        <tr>
            <td colspan="4">No hay usuarios disponibles</td>
        </tr>
    }
    </tbody>

</table>
<div *ngIf="showForm" style="margin-top: 20px;">
    <h3>{{ textoModal }}</h3>
    <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
                <label for="username">Nombre de usuario</label>
                <input id="username" class="form-control" formControlName="username" minlength="5" maxlength="20">
            </div>
            <div class="form-group">
                <label for="password">Contraseña</label>
                <input id="password" class="form-control" formControlName="password" minlength="8">
            </div>
            <div class="form-group">
                <label for="roles">Roles</label>
                                <select id="roles" class="form-control" formControlName="roles" multiple (change)="onRolesChange($event)">
                                    <option *ngFor="let rol of roles" [value]="rol">{{ transformarRol(rol) }}</option>
                                </select>
            </div>
      <button type="submit" class="btn btn-primary" [disabled]="usuarioForm.invalid" style="margin-top: 20px;">
        Guardar
      </button>
    <button type="button" class="btn btn-secondary" (click)="cancelar()" style="margin-top: 20px; margin-left: 10px;">
        Cancelar
    </button>
    </form>
</div>
</div>